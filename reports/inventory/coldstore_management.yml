query: SELECT   locations.location_code,  locations.id,  locations.location_type_code,  locations.location_status,  locations.location_maximum_units,  locations.units_in_location,  locations.parent_location_code,  (select transaction_statuses.status_code from transaction_statuses where transaction_statuses.status_type_code = 'COLDSTORE' and transaction_statuses.object_id = locations.id order by id desc limit 1) as current_status,  (select transaction_statuses.created_on from transaction_statuses where transaction_statuses.status_type_code = 'COLDSTORE' and transaction_statuses.object_id = locations.id order by id desc limit 1) as current_status_date,  (select transaction_statuses.created_on from transaction_statuses where transaction_statuses.status_type_code = 'COLDSTORE' and transaction_statuses.object_id = locations.id  and transaction_statuses.status_code ='LOADING' order by id desc limit 1) as date_loaded,  (select transaction_statuses.created_on from transaction_statuses where transaction_statuses.status_type_code = 'COLDSTORE' and transaction_statuses.object_id = locations.id  and transaction_statuses.status_code like '%SEALED%' order by id desc limit 1) as date_sealed,  (select transaction_statuses.created_on from transaction_statuses where transaction_statuses.status_type_code = 'COLDSTORE' and transaction_statuses.object_id = locations.id  and transaction_statuses.status_code = 'OPEN' order by id desc limit 1) as date_opened FROM locations WHERE (locations.location_code={locations.location_code} and locations.location_type_code={locations.location_type_code} and locations.location_status={locations.location_status}and locations.parent_location_code={locations.parent_location_code})
main_table_name: locations