<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" >

<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <style type="text/css"> body, html {margin:0px; padding: 0px;} </style>

      <%= stylesheet_link_tag "delivery" , "child_form","iframe", 'coderay' %>

    <% if ENV['RAILS_ENV'] == 'development' -%>
      <script src = "/javascripts/lib/prototype.js" type="text/javascript"></script>

      <script src = "/javascripts/fields_seq.js" type="text/javascript"></script>
      <script src = "/javascripts/separators.js" type="text/javascript"></script>
      <script src = "/javascripts/popupwindow.js" type="text/javascript"></script>
      <script src = "/javascripts/field_show_popup.js" type="text/javascript"></script>

      <!--script src = "/javascripts/src/scriptaculous.js" type="text/javascript"></script-->
      <!--script src = "/javascripts/src/effects.js" type="text/javascript"></script-->
      <!--script src = "/javascripts/src/dragdrop.js" type="text/javascript"></script-->
      <script src = "/javascripts/tabs.js" type="text/javascript"></script>
      <script src = "/javascripts/progressbar.js" type="text/javascript"></script>
      <script src = "/javascripts/window_finder.js" type="text/javascript"></script>
      <script src = "/javascripts/session.js" type="text/javascript"></script>
      <script src = "/javascripts/tablesort.js" type="text/javascript"></script>

      <script src = "/javascripts/jquery.min.js" type="text/javascript"></script>

      <script src = "/javascripts/jquery-ui.min.js" type="text/javascript"></script>
      <script src = "/javascripts/ui.multiselect.js" type="text/javascript"></script>
      <script src = "/javascripts/jquery.collapse.js" type="text/javascript"></script>
      <script src = "/javascripts/jquery-ui-timepicker-addon.js" type="text/javascript"></script>
      <script src = "/javascripts/util.js" type="text/javascript"></script>
      <script src = "/javascripts/jquery.fullscreen-min.js" type="text/javascript"></script>
      <script src = "/javascripts/search_form.js" type="text/javascript"></script>
      <script src = "/javascripts/jquery.event.drag-2.2.js" type="text/javascript"></script>
      <script src = "/javascripts/content_layout.js" type="text/javascript"></script>

      <script src = "/javascripts/underscore.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.core.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.checkboxselectcolumn.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.columnpicker.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.pager.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.dataview.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.groupitemmetadataprovider.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.remotemodel.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.autotooltips.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.cellcopymanager.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.cellrangedecorator.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.cellrangeselector.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.cellselectionmodel.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.rowselectionmodel.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.formatters.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.editors.js" type="text/javascript"></script>
      <script src = "/javascripts/slick.grid.js" type="text/javascript"></script>
      <!--script src = "/javascripts/slick.headerbuttons.js" type="text/javascript"></script-->
      <!--script src = "/javascripts/slick.headermenu.js" type="text/javascript"></script-->
      <script src = "/javascripts/ext.headerfilter.js" type="text/javascript"></script>
      <script src = "/javascripts/slgrid_utils.js" type="text/javascript"></script>
      <script src = "/javascripts/jquery.contextMenu.js" type="text/javascript"></script>
      <script src = "/javascripts/chosen.jquery.min.js" type="text/javascript"></script>

    <% else %>
      <script src = "/javascripts/content_all.js" type="text/javascript"></script>
    <% end %>

    <link href="/stylesheets/jskr1/jquery-ui.css" rel="stylesheet" type="text/css"/>

      <script type="text/javascript" language="JavaScript">
        <% if ENV['RAILS_ENV'] == 'development' -%>
          noSession = true; // JS - TURN OFF SESSION EXPIRY
        <% end -%>

        grid_min_width= <%= grid_min_width%>;
        grid_min_height= <%= grid_min_height%>;
        var colSizes = null;
        
        <% if session[:alert] != nil %>
            alert("<%= session[:alert] %>");
          <% session[:alert]= nil %>
        <%end%>


        <% if @content_header_caption != nil ||@child_form_caption != nil%>
            if(is_outer_form())
              <% @content_header_caption = '' if @content_header_caption.nil? %>
              window.parent.set_content_header_caption( '<%= @content_header_caption.gsub(/"|'/,'') %>' );
            else
          <% if @child_form_caption != nil%>
            <% if @child_form_caption.class.to_s == "Array" && @child_form_caption.length() == 2 %>
                  window.parent.set_child_form_caption("<%=@child_form_caption[0]%>","<%=@child_form_caption[1]%>");
            <%end%>
          <% else%>
              ;
          <% end%>
        <%end%>

        <%if @info_sticker %>
            window.parent.add_info_sticker("<%= @info_sticker %>");
        <%end%>
        
        
        home_window = null;
        if(window.parent.document.getElementById('content_container')!== null) {
          home_window = window.parent;
        }
        else {
          home_window = window.parent.parent;
        }

        <%if @info %>
            home_window.set_info("<%= @info %>");
          <%if @show_info_popup  %>
              home_window.show_info();
          <%end%>
        <% else%>
            home_window.clear_info();
        <%end%>
        
        function flash_effect()
        {
        <% if flash[:notice] && !(@freeze_flash) %>
            //Effect.SwitchOff('notice');
          //  Effect.Fade('notice',{duration: 10});
          jQuery('#notice').delay(10000).fadeOut(1000);
          jQuery(document).keyup(function(e) {
            if (e.keyCode == 27) { // Hide message when ESC is pressed.
                  jQuery('#notice').hide();
              }
          });
        <% end %>
        <% if flash[:notice_icon] && !(@freeze_flash) %>
          jQuery('#notice-icon').delay(3000).fadeOut(1000)
          jQuery(document).keyup(function(e) {
            if (e.keyCode == 27) { // Hide message when ESC is pressed.
                  jQuery('#notice-icon').hide();
              }
          });
        <% end %>
        }
  		
      </script>

      <%= @header_content %>

      <title>Admin</title>
      <%= stylesheet_link_tag "scaffold", "depot", "admin", "web_pdt" %>
      <%= stylesheet_link_tag "ui.multiselect.css" %>
      <%= stylesheet_link_tag "ui.jqgrid.css" %>
      <%#= stylesheet_link_tag "redmond/jquery-ui.css" %>
      <%= stylesheet_link_tag "jskr1/jquery-ui.css" %>
      <%= stylesheet_link_tag "slick.grid.css" %>
      <%= stylesheet_link_tag "slick.columnpicker.css" %>
      <%= stylesheet_link_tag "slick.pager.css" %>
      <%= stylesheet_link_tag "slick.headerbuttons.css" %>
      <%= stylesheet_link_tag "slick.headermenu.css" %>
      <%= stylesheet_link_tag "slick.filter.css" %>
      <%= stylesheet_link_tag "slick.filter.excel.css" %>
      <%= stylesheet_link_tag "jquery.contextMenu.css" %>
      <%= stylesheet_link_tag "chosen.css" %>
      <%= stylesheet_link_tag "grid_icons_n_colours.css" %>
      <style type="text/css">
        /* Override font sizes for jqGrid and dialogs */
        .ui-jqgrid tr.ui-row-ltr td { font-size: 11px }
        .ui-jqgrid .ui-jqgrid-htable th div { font-size: 12px }
        .ui-jqgrid .ui-jqgrid-titlebar { font-size: 12px; }
        .ui-dialog { font-size: 12px; }
        .ui-jqdialog-content, .ui-jqdialog .ui-jqdialog-content { font-size: 12px; }
      </style>

     <%= yield :head_extras %>
  </head>

  <body  onload ="if(window.parent.contentFrame_loaded) {window.parent.contentFrame_loaded(); } flash_effect();" >
    <div id="zoomgridclose" style="position:absolute;right:0px;top:0px;z-index:2001;visibility:hidden" ><img onclick="miniMize()" src="/images//messages/close_form.png"/></div>
    <div id="jqgridminimize" style="position:absolute;right:0px;top:0px;z-index:2001;visibility:hidden" onclick="jqGridMinimize()">Normal size</div>

    <div id="dialog-modal" title="Modal dialog">
    </div>
    <!--<div id="banner">
    <%= @page_title  %>
    </div>  -->

    <% if @content_header_caption != nil  %>
      <script type="text/javascript">
        if(document.getElementById('content_header') == null ) {
          if(window.opener != null) {
            document.write(" <div id='content_header' style='vertical-align: top;' >&nbsp; </div>");
            <% @content_header_caption = '' if @content_header_caption.nil? %>
            set_content_header_caption('<%= @content_header_caption.gsub(/"|'/,'') %>');
            toggle_content_header_border(true);
          }
        }
      </script>
    <% end %>

    <div id="maine" style = "vertical-align: top;" >

      <% if flash[:notice_icon] -%>
        <div id="notice-icon" style="z-index:22;position:absolute;top:100px;right:100px;min-height:50px;min-width:50px;background-color: cornflowerblue;">
          <%= image_tag 'notice_ok.png' %>
        </div>
      <% end -%>
      <% if flash[:notice] -%>
        <div id="notice" style="z-index:22;position:absolute;min-width:800px;"><%= flash[:notice] %>
          <span class="hoverhigh" style="float:right;"><img onclick="jQuery('#notice').hide()" title="close" src="/images/grid_icons/cross.png" /></span></div>
        </div>
      <% end -%>
      <% if flash[:error] -%>
        <div id="error" class = "error" style="z-index:22;position:absolute;min-width:800px;"><%= flash[:error] %>
          <span class="hoverhigh" style="float:right;"><img onclick="jQuery('#error').hide()" title="close" src="/images/grid_icons/cross.png" /></span></div>
        <%flash[:error] = nil%>
      <% end -%>

      <table>
        <tr>
          <td id = 'applet_container'>
            <% unless @pagination.nil? -%>
              <div style="position:fixed;padding:4px 8px;background-color:#fff;z-index:9;top:10px;right:10px;border-radius:6px;">Page: <%= @pagination %></div>
            <% end -%>
            <%= @content_for_layout %>
          </td>
        </tr>
      </table>

    </div>
    <div id = 'empty_shell'></div>

    <div id="record_div" style="position:absolute; overflow:auto; background-color:#D8D6D4;"></div>

    <% if ENV['RAILS_ENV'] == 'SWITCHEDOFFdevelopment' -%>
      <div id="debug" style="margin: 5px 5px 5px 5px;">
          <a href="#" onclick="jQuery('#debug_info').toggle();return false" style="text-decoration: none; color: #333;">Show Debug Info &#10162;</a>
          <div id="debug_info" style="display : none;">
              <%= debug session %>
              <%= debug params %>
          </div>
      </div>
    <% end -%>

  </body>
</html>

